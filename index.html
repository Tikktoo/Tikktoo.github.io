<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Martin">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Martin">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Martin">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Martin</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Martin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/17/移动端如何做适配/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/17/移动端如何做适配/" itemprop="url">移动端是怎么做适配的？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-17T21:37:22+08:00">
                2018-11-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="移动端是怎么做适配的？"><a href="#移动端是怎么做适配的？" class="headerlink" title="移动端是怎么做适配的？"></a>移动端是怎么做适配的？</h1><h2 id="一、meta-viewport"><a href="#一、meta-viewport" class="headerlink" title="一、meta viewport"></a><strong>一、meta viewport</strong></h2><p>在head标签内部加上这段代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>该meta标签的作用是让当前viewport的宽度等于设备的宽度，同时不允许用户手动缩放。也许允不允许用户缩放不同的网站有不同的要求，但让viewport的宽度等于设备的宽度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">width=device-width: 让当前viewport宽度等于设备的宽度</span><br><span class="line">user-scalable=no: 禁止用户缩放</span><br><span class="line">initial-scale=1.0: 设置页面的初始缩放值为不缩放</span><br><span class="line">maximum-scale=1.0: 允许用户的最大缩放值为1.0</span><br><span class="line">minimum-scale=1.0: 允许用户的最小缩放值为1.0</span><br></pre></td></tr></table></figure>
<h2 id="二、媒体查询（响应式）"><a href="#二、媒体查询（响应式）" class="headerlink" title="二、媒体查询（响应式）"></a><strong>二、媒体查询（响应式）</strong></h2><p><strong>格式一：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@media （）and（）&#123;&#125;</span><br><span class="line">//满足（）里的条件，就执行大括号里css的样式</span><br></pre></td></tr></table></figure>
<p><strong>举例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">@media (max-width:320px)&#123;</span><br><span class="line">    body&#123;</span><br><span class="line">        background:red;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width:321px) and (max-width:320px)&#123;</span><br><span class="line">    body&#123;</span><br><span class="line">        background:orange;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width:376px) and (max-width:425px)&#123;</span><br><span class="line">    body&#123;</span><br><span class="line">        background:green;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width:426px) and (max-width:768px)&#123;</span><br><span class="line">    body&#123;</span><br><span class="line">        background:blue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@media (min-width:769px)&#123;</span><br><span class="line">    body&#123;</span><br><span class="line">        background:grey;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p><strong>格式二并举例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;media=&quot;(max-width:320px)&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>注意点：</p>
<p>1、link标签会下载好，但是是否生效取决于media的条件；</p>
<p>2、有PC端经验，就有移动端经验，只是多了一个media查询；</p>
<p>3、通过添加多个css样式来满足不同的屏幕宽度；</p>
<h2 id="三、动态rem方案"><a href="#三、动态rem方案" class="headerlink" title="三、动态rem方案"></a><strong>三、动态rem方案</strong></h2><p>1rem等于根元素html的font-size的值，那么可以调整根元素的font-size值来调整页面缩放后的各个元素的尺寸和定位。</p>
<p>在script标签加入这段代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">   var pageWidth=window.innerWidth  //获取屏幕宽度</span><br><span class="line">   document.documentElement.style.fontSize= `$&#123;pageWidth/60&#125;px`</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>此处，fontSizede的值为屏幕宽的十分之一，那么在写CSS的时候可以这样写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.xxx&#123;</span><br><span class="line">    width:0.4rem;</span><br><span class="line">    height:0.2rem;</span><br><span class="line">    margin:0.05rem 0.05rem;</span><br><span class="line">    float:left;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>用sass将px转化为rem：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@function px( $px )&#123;</span><br><span class="line">  @return $px/$designWidth*10 + rem;</span><br><span class="line">&#125;</span><br><span class="line">$designWidth: 320px; </span><br><span class="line"></span><br><span class="line">那么1rem=32px</span><br></pre></td></tr></table></figure>
<h2 id="四、对动态rem进行微调"><a href="#四、对动态rem进行微调" class="headerlink" title="四、对动态rem进行微调"></a><strong>四、对动态rem进行微调</strong></h2><p>1、rem都是小数很不方便。所以让 html 的 font-size 的尺寸等于 window.innerWidth/10；</p>
<p>2、浏览器默认可设置的最小字体大小为12px，浏览器默认可设置的最小字体大小为12px，浏览器默认可设置的最小字体大小为12px；</p>
<p>3、在精细的地方，就直接写像素，混用px rem em</p>
<ul>
<li>比如border:1px solid red;</li>
<li>比如页面字体的大小就直接写font-size:16px</li>
</ul>
<h2 id="五、其他补充"><a href="#五、其他补充" class="headerlink" title="五、其他补充"></a><strong>五、其他补充</strong></h2><p><strong>1、px em rem vh vw的区别</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">px：表示像素</span><br><span class="line">em：一个字的高度 //1em == 自己font-size的值</span><br><span class="line">rem：root em // 根元素html的font-size</span><br><span class="line">vh：viewport height   视口高度=100vh</span><br><span class="line">vw：viewport width    视口宽度=100vw</span><br></pre></td></tr></table></figure>
<p>2、body默认字体为16px，其中chrome默认可设置的最小字体大小为12px，更改body的font-size是rem是不会变的，更改的必须是html的font-size。</p>
<p><strong>3、百分比布局和整体缩放布局的区别</strong></p>
<p>百分比布局：无法让高度跟着屏幕宽度改变而进行有比例的改变，高度和宽度无法做任何的配合；</p>
<p>整体缩放布局：一切单位以宽度为基准。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/17/用JS做一个自己的导航网页/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/17/用JS做一个自己的导航网页/" itemprop="url">用JS做一个自己的导航网页</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-17T21:26:01+08:00">
                2018-11-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="用JS做一个自己的导航网页"><a href="#用JS做一个自己的导航网页" class="headerlink" title="用JS做一个自己的导航网页"></a>用JS做一个自己的导航网页</h1><p><strong>关键词：</strong>原生JavaScript、locationStorage、JSON、favicon、onerror、图床、CSS Gradient Generator</p>
<p><strong>描述：</strong>该项目使用原生JS实现一个键盘导航，该导航支持百度、谷歌搜索，键盘字母绑定自定义的网站。协议+域名+/favicon 作为 URL，请求成功后能够获取到网站的图标，用CSS Gradient Generator 实现了键盘颜色的渐变，用locationStorage实现了用户输入url保存到本地的功能。</p>
<p><strong>源码链接：</strong></p>
<p><a href="https://github.com/Tikktoo/My-Navigation" target="_blank" rel="noopener">https://github.com/Tikktoo/My-Navigation</a></p>
<p><strong>预览链接：</strong></p>
<p><a href="https://tikktoo.github.io/My-Navigation/index.html" target="_blank" rel="noopener">https://tikktoo.github.io/My-Navigation/index.html</a></p>
<h2 id="一、页面分析"><a href="#一、页面分析" class="headerlink" title="一、页面分析"></a><strong>一、页面分析</strong></h2><p><strong>1、数据的储存</strong></p>
<ul>
<li>一个二维数组来表示n行键盘，这里的n为4</li>
<li>一个hash储存键（键盘的上的字母）值（网址）</li>
</ul>
<p><strong>2、视觉部分</strong></p>
<p>css表示：定位、色彩、动画、hover</p>
<p><strong>3、事件绑定</strong></p>
<ul>
<li>键盘点击事件：onkeypress</li>
<li>鼠标点击事件：onclick</li>
<li>图片加载失败：onerror</li>
</ul>
<h2 id="二、用到的知识点"><a href="#二、用到的知识点" class="headerlink" title="二、用到的知识点"></a><strong>二、用到的知识点</strong></h2><p><strong>1、关于locationStorage</strong>，注意保存的是字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">localStorage.getItem(key)  //获取指定key本地存储的值</span><br><span class="line">localStorage.setItem(key,value)  //将value存储到key字段</span><br><span class="line">localStorage.removeItem(key)  //删除指定key本地存储的值</span><br></pre></td></tr></table></figure>
<p><strong>2、关于JSON</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JSON.stringfy()  //将对象、数组转换成字符串</span><br><span class="line">JSON.parse()  //将字符串转成json对象</span><br></pre></td></tr></table></figure>
<p>将locationStorage取出或存进去，都可以用JSON的API来进行转化</p>
<p><strong>3、favicon</strong></p>
<p>在键盘里的button输入网站地址后确认，会在键盘左下角获取该网站的logo图，这里用到的是favicon，约定一个网站后面接/favicon.ico就会跳转到该网站logo的url，比如百度：</p>
<p><a href="https://www.baidu.com/favicon.icowww.baidu.com" target="_blank" rel="noopener">https://www.baidu.com/favicon.icowww.baidu.com</a></p>
<p><strong>4、onerror</strong></p>
<p>onerror事件会在文档或图像加载过程中发生错误时被触发。因为我们要获取logo，假如没有获取成功，会使得页面很难看。所以可以……呈现出一个已经准备好的图片。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">image.onerror=function(aaa)&#123;</span><br><span class="line">     aaa.target.src=&apos;https://i.loli.net/2018/05/02/5ae95aee4a6c2.png&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>5、图床</strong></p>
<p>做好的图片转化为url使用，这里推荐一个网站：</p>
<p><a href="https://sm.ms/" target="_blank" rel="noopener">https://sm.ms/</a></p>
<p><strong>6、CSS Gradient Generator</strong></p>
<p>这里推荐一个网站自动生成代码：</p>
<p><a href="http://www.colorzilla.com/gradient-editor/www.colorzilla.com" target="_blank" rel="noopener">http://www.colorzilla.com/gradient-editor/www.colorzilla.com</a></p>
<p><strong>7、JS</strong></p>
<p>获取元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var xxx = document.getElementsByClassName(&apos;xxx&apos;)</span><br><span class="line">var xxx = document.getElementById(&apos;xxx&apos;)</span><br><span class="line">var xxx = document.querySelector(&apos;xxx&apos;)</span><br></pre></td></tr></table></figure>
<p>找元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var yyy=xxx.previousSibling  //找xxx的前面一个兄弟元素</span><br><span class="line">var yyy=xxx.nextSibling  //找xxx的后面一个兄弟元素</span><br><span class="line">var yyy=xxx.parentElement //找xxx的父元素</span><br><span class="line">var yyy=xxx.firstChild //找xxx的第一个子元素，也可以是last子元素</span><br></pre></td></tr></table></figure>
<p>创建元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var xxx = document.createElement(tagName)</span><br></pre></td></tr></table></figure>
<p>插入元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yyy.appendChild(xxx)</span><br></pre></td></tr></table></figure>
<p>所以会发现，一直在找元素，创建元素，插入元素。如果加一个for循环就可以批量创建元素了。</p>
<h2 id="三、怎么做？"><a href="#三、怎么做？" class="headerlink" title="三、怎么做？"></a><strong>三、怎么做？</strong></h2><p><strong>1、数据储存</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var keys = &#123;</span><br><span class="line">   0:[&apos;1&apos;,&apos;2&apos;,&apos;3&apos;,&apos;4&apos;,&apos;5&apos;,&apos;6&apos;,&apos;7&apos;,&apos;8&apos;,&apos;9&apos;,&apos;0&apos;],</span><br><span class="line">   1:[&apos;q&apos;,&apos;w&apos;,&apos;e&apos;,&apos;r&apos;,&apos;t&apos;,&apos;y&apos;,&apos;u&apos;,&apos;i&apos;,&apos;o&apos;,&apos;p&apos;],</span><br><span class="line">   2:[&apos;a&apos;,&apos;s&apos;,&apos;d&apos;,&apos;f&apos;,&apos;g&apos;,&apos;h&apos;,&apos;j&apos;,&apos;k&apos;,&apos;l&apos;],</span><br><span class="line">   3:[&apos;z&apos;,&apos;x&apos;,&apos;c&apos;,&apos;v&apos;,&apos;b&apos;,&apos;n&apos;,&apos;m&apos;],</span><br><span class="line">   length:4,</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">var hash=&#123;</span><br><span class="line">   q:&apos;www.qq.com&apos;,</span><br><span class="line">   w:&apos;www.weibo.com&apos;,</span><br><span class="line">   e:&apos;www.ele.me&apos;,</span><br><span class="line">   z:&apos;www.zhihu.com&apos;,</span><br><span class="line">   m:&apos;www.mcdonalds.com.cn&apos;</span><br><span class="line">   //可以不写全，也可以不写，让hash是一个空对象</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><strong>2、遍历二维数组keys</strong>，创建所需要的元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var index=0;</span><br><span class="line">while(index&lt;keys[&apos;length&apos;])&#123;</span><br><span class="line">   var div1 =  creativeDiv(&apos;div&apos;);</span><br><span class="line">   var row=keys[index];</span><br><span class="line">   for(var number=0;number&lt;row.length;number++)&#123;  </span><br><span class="line">      var kbd = createKbd(row[number]);</span><br><span class="line">      var button = createButton(row[number]);   </span><br><span class="line">      var image = createImage(hash[row[number]]); </span><br><span class="line">      kbd.classList.add(row[number]) </span><br><span class="line">   &#125;</span><br><span class="line">   index=index+1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>解释：</strong></p>
<ul>
<li>创建4个div表示行，creativeDiv()</li>
<li>每个div创建对应数量的kbd表示键盘字母，createKbd()</li>
<li>每个kbd创建一个button用来点击输入网址，createButton()</li>
<li>每个kbd再创建一个img用来展示网站的logo，createImage()</li>
</ul>
<p><strong>以上四个函数均已封装过，这里说一下createButton()</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">function createButton(id)&#123;</span><br><span class="line">    //插入button按钮，用户输入更改hash网址</span><br><span class="line">    var  button = c(&apos;button&apos;);//创建button元素，封装过的函数</span><br><span class="line">    button.id = id;</span><br><span class="line">    kbd.appendChild(button);</span><br><span class="line">   //绑定鼠标点击事件</span><br><span class="line">    button.onclick = function(xxx)&#123;</span><br><span class="line">       var button2=xxx.target;</span><br><span class="line">       var image2=button2.previousSibling;</span><br><span class="line">       var key = button2.id;</span><br><span class="line">       x = prompt(&apos;请输入键位&apos;+key+&apos;对应的网站地址&apos;)</span><br><span class="line">       hash[key] = x; //变更网址</span><br><span class="line">       image2.src=&apos;http://&apos;+hash[row[number]]+&apos;/favicon.ico&apos;;</span><br><span class="line">       image.onerror=function(aaa)&#123;</span><br><span class="line">            aaa.target.src=&apos;https://i.loli.net/2018/05/02/5ae95aee4a6c2.png&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">        localStorage.setItem(&apos;zzz&apos;,JSON.stringify(hash)); </span><br><span class="line">        window.location.reload()</span><br><span class="line">   &#125;</span><br><span class="line">    button.textContent = &quot;E&quot;;</span><br><span class="line"> return button;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>再说一下createImage()</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function createImage(domain)&#123;</span><br><span class="line">   //插入image icon 图标</span><br><span class="line">    var image=c(&apos;img&apos;);</span><br><span class="line">    kbd.appendChild(image);</span><br><span class="line">   //domain === hash[row[number]] 表示地址存在</span><br><span class="line">    if(domain)&#123;</span><br><span class="line">        image.src=&apos;http://&apos;+hash[row[number]]+&apos;/favicon.ico&apos;;</span><br><span class="line">    &#125; else&#123;</span><br><span class="line">        image.src=&apos;https://i.loli.net/2018/05/02/5ae95aee4a6c2.png&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    image.onerror=function(aaa)&#123;</span><br><span class="line">        aaa.target.src=&apos;https://i.loli.net/2018/05/02/5ae95aee4a6c2.png&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"> return image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>3、事件监听</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">body.onclick = function (evt)&#123;</span><br><span class="line">   if(evt.target.localName == &quot;input&quot;)&#123;</span><br><span class="line">      document.onkeypress=&apos;&apos;; </span><br><span class="line">   &#125;else if(evt.target.localName == &quot;kbd&quot;)&#123;</span><br><span class="line">       var classNumber = evt.target.className[4];//key w ,w是在第5位</span><br><span class="line">       website=hash[classNumber];</span><br><span class="line">       isWebsite(website)</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">       document.onkeypress=function(xxx)&#123;</span><br><span class="line">       key=xxx[&apos;key&apos;];  //将监听的键盘字母保存到变量key</span><br><span class="line">       website=hash[key];  //获取hash数组的值（网站地址）保存变量website;</span><br><span class="line">       //在当前窗口打开网站</span><br><span class="line">       //location.href = &quot;http://&quot;+website</span><br><span class="line">       //在新窗口打开网站</span><br><span class="line">       isWebsite(website)         </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>解释：</strong></p>
<ul>
<li>当鼠标点击body的时候，判断点击的元素是input，还是kbd，还是其他</li>
<li>当为input时，那么取消onkeypress的监听</li>
<li>当为kbd时，获取kbd元素的className所对应的website，并打开跳转该网址</li>
<li>其余情况对键盘进行监听，获取键盘所对应的website，并打开跳转该网址</li>
</ul>
<p>这里的 isWebsite()是为了解决一个bug,如果用户打开button什么也不输入直接点确定，那么hash存的值为undefined或null就均不跳转。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function isWebsite(website)&#123;</span><br><span class="line"> if(website === undefined || website === null)&#123;</span><br><span class="line">     return</span><br><span class="line"> &#125;else&#123;</span><br><span class="line">     window.open(&apos;http://&apos;+website,&apos;_blank&apos;);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>4、百度搜索、谷歌搜索跳转</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form class=&quot;formButton&quot;name=&quot;s&quot; action=&quot;http://www.baidu.com/s&quot;&gt; </span><br><span class="line">   &lt;input class=&quot;text&quot;type=&quot;text&quot; id=&quot;q&quot; name=&quot;wd&quot; autocomplete=&quot;on&quot; value=&quot;&quot;&gt;</span><br><span class="line">   &lt;input type=&quot;button&quot; class=&quot;button&quot; onclick=&quot;window.open(&apos;http://www.baidu.com/s?wd=&apos;+s.wd.value,&apos;&apos;)&quot; value=&quot;百度一下&quot;&gt;</span><br><span class="line">   &lt;input type=&quot;button&quot; class=&quot;button&quot; onclick=&quot;window.open(&apos;http://www.google.com/search?q=&apos;+s.wd.value,&apos;&apos;)&quot; value=&quot;谷歌搜索&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p>放上这段代码就可以了。。。</p>
<p><strong>5、对代码优化，对函数进行封装</strong></p>
<p>具体代码查看我的github</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/17/canvas画板/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/17/canvas画板/" itemprop="url">canvas画板</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-17T20:18:31+08:00">
                2018-11-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="canvas画板"><a href="#canvas画板" class="headerlink" title="canvas画板"></a>canvas画板</h2><blockquote>
<p>这是我做的第一个项目画板，故记录知识点方便以后回顾。有两种方式：div 和 canvas，选择了用 canvas 做。</p>
</blockquote>
<p><strong>关键词：</strong>原生 JavaScript、Canvas、移动端、SVG、特性检测</p>
<p><strong>描述：</strong>该项目使用原生 JS 实现，主要调用 Canvas API，实现了线粗、调色、橡皮擦、保存等功能。用 context.clearRect() 实现了 橡皮檫和清屏的功能，用 className 切换实现了笔的线粗、颜色切换的功能，用 meta:vp、特性检测、ontouch 事件实现了触屏设备与 web 端兼容。</p>
<p><strong>源码链接：</strong></p>
<p><a href="https://github.com/Tikktoo/canvas?1542456503380" target="_blank" rel="noopener">https://github.com/Tikktoo/canvas?1542456503380</a></p>
<p><strong>预览链接：</strong></p>
<p><a href="https://tikktoo.github.io/canvas/index2.html" target="_blank" rel="noopener">https://tikktoo.github.io/canvas/index2.html</a></p>
<h2 id="一、div-VS-canvas-选哪个？"><a href="#一、div-VS-canvas-选哪个？" class="headerlink" title="一、div VS canvas 选哪个？"></a><strong>一、div VS canvas 选哪个？</strong></h2><p>如果用 div 做画板，那么思路是这样的：</p>
<ul>
<li>document.onmousedown：鼠标点击画一个圆，获取点击的坐标；创建 div；设置 div 样式；</li>
<li>document.onmousemove：移动创建圆：把 1 复制到 2 里，然后使用标记，未点击是 false，点击是 true，松开是 false；</li>
<li>doucment.onmouseup：鼠标松开，完成绘绘画；</li>
</ul>
<p>然后缺点是<strong>快速移动无法形成连续的圆</strong>，so 不能用 div 来做画板。而 canvas 解决了这个不足的地方。</p>
<p><strong>原理：鼠标点击形成一个‘填充圆’并获取坐标，鼠标移动后会形成另一个‘填充圆’获取另一个坐标，然后两坐标用直线相连。</strong></p>
<p>让我们看下如何一步步用 canvas 实现画板。</p>
<h2 id="二、cavans-提供的画图-API"><a href="#二、cavans-提供的画图-API" class="headerlink" title="二、cavans 提供的画图 API"></a><strong>二、cavans 提供的画图 API</strong></h2><p><strong>1、使用 canvas</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var canvas=document.getElementById(&apos;canvas&apos;);</span><br><span class="line">var context=canvas.getContext(&apos;2d&apos;);</span><br></pre></td></tr></table></figure>
<p><strong>2、封装一个画实心圆的函数</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function drawCir(x,y)&#123;</span><br><span class="line">    context.beginPath()</span><br><span class="line">    context.arc(x,y,0.1,0,Math.PI*2)</span><br><span class="line">    context.fill();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>3、封装一条画直线的函数</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function drawLine(x1,y1,x2,y2)&#123;</span><br><span class="line">    context.beginPath();</span><br><span class="line">    context.lineWidth=2;</span><br><span class="line">    context.moveTo(x1,y1);</span><br><span class="line">    context.lineTo(x2,y2);</span><br><span class="line">    context.stroke();</span><br><span class="line">    context.closePath();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意 context.cloasePath()，表示关闭路径，线宽在开始和结束只能用一次，如果有多个颜色就要进行多次的开始和结束。</p>
<p><strong>4、删除内容，橡皮檫</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">context.clearRect(x坐标,y坐标,长,宽);</span><br><span class="line">//x和y的坐标都可以动态获取</span><br></pre></td></tr></table></figure>
<h2 id="三、然后怎么做？"><a href="#三、然后怎么做？" class="headerlink" title="三、然后怎么做？"></a><strong>三、然后怎么做？</strong></h2><p><strong>1、首先我们要给画板设置视口宽高，并封装成函数</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function setCanvasSize()&#123;</span><br><span class="line">    var pageWidth=document.documentElement.clientWidth;</span><br><span class="line">    var pageHeight=document.documentElement.clientHeight;</span><br><span class="line">    canvas.width = pageWidth;</span><br><span class="line">    canvas.height = pageHeight;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>如果我们窗口变化了，可以调用这个函数重新设置 canvas 的宽高。</p>
<p><strong>2、实现能画图</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">var using=false;</span><br><span class="line">var lastPoint=&#123;</span><br><span class="line">    x:undefined,y:undefined</span><br><span class="line">&#125;</span><br><span class="line">//鼠标点击监听</span><br><span class="line">canvas.onmousedown=function(aaa)&#123;</span><br><span class="line"> var x=aaa.clientX;</span><br><span class="line"> var y=aaa.clientY;</span><br><span class="line">    using=true;</span><br><span class="line">    lastPoint=&#123;x:x,y:y&#125;;</span><br><span class="line"> if(eraserEnabled)&#123;</span><br><span class="line">        context.clearRect(x-10,y-10,20,20);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        drawCir(x,y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//鼠标移动监听</span><br><span class="line">canvas.onmousemove=function(aaa)&#123;</span><br><span class="line"> var x=aaa.clientX;</span><br><span class="line"> var y=aaa.clientY;</span><br><span class="line"> var newPoint=&#123;x:x,y:y&#125;</span><br><span class="line"> if(using)&#123;</span><br><span class="line"> if(eraserEnabled)&#123;</span><br><span class="line">            context.clearRect(x-10,y-10,20,20);</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">            drawCir(x,y);</span><br><span class="line">            drawLine(lastPoint.x,lastPoint.y,newPoint.x,newPoint.y)</span><br><span class="line">            lastPoint=newPoint;      </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;       </span><br><span class="line"></span><br><span class="line">//鼠标松开监听</span><br><span class="line">canvas.onmouseup=function(aaa)&#123;</span><br><span class="line">    using=false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意，做一个 “锁” 来切换点击状态 var using=false。</p>
<p><strong>3、引入 SVG：铅笔、橡皮、清屏、下载</strong></p>
<p>在 iconfont 里找到自己想要的 icon，按照说明帮助使用 smybol 引用：</p>
<p>Iconfont - 阿里巴巴矢量图标库iconfont.cn</p>
<p><strong>4、通过点击事件用 js 切换 className</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xxx.onclick=function()&#123;</span><br><span class="line">    xxx.classList.add(&apos;active&apos;);</span><br><span class="line">    yyy.classList.remove(&apos;active&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解释：给一个元素的状态激活增加 active，给另一个元素的取消激活状态移除 active。xxx 代表点击事件监听的元素，比如 pen 的粗细切换、颜色切换，pen 和 eraser 切换进行红色高亮。</p>
<p><strong>5、增加清屏功能</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">clear.onclick=function()&#123;</span><br><span class="line">     context.clearRect(0,0,canvas.clientWidth,canvas.clientHeight);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>6、增加下载图片功能</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">download.onclick = function()&#123;</span><br><span class="line">    var url = canvas.toDataURL(&apos;image/png&apos;);</span><br><span class="line">    var a = document.createElement(&apos;a&apos;);</span><br><span class="line">    document.body.appendChild(a);</span><br><span class="line">    a.href=url;</span><br><span class="line">    a.download=&apos;my drawing&apos;;</span><br><span class="line">    a.click();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>7、解决移动页面宽度（在手机能看）</strong></p>
<p>在 head 加一个 meta:vp:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,</span><br><span class="line">initial-scale=1,user-scalable=no,</span><br><span class="line">maximum-scale=1.0,minimum-scale=1.0&quot;/&gt;</span><br><span class="line"></span><br><span class="line">页面宽度=移动宽度 ：width=device-width</span><br><span class="line">用户不可以缩放：user-scalable=no</span><br><span class="line">缩放比例：initial-scale=1</span><br><span class="line">最大缩放比例：maximum-scale=1.0</span><br><span class="line">最小缩放比例：minimum-scale=1.0</span><br></pre></td></tr></table></figure>
<p><strong>8、特性检测没有 onmouse 事件，用 ontouch 事件</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">document.ontouchstart =function()&#123;&#125;</span><br><span class="line">document.ontouchmove = function()&#123;&#125;</span><br><span class="line">document.ontouchend = function()&#123;&#125;</span><br></pre></td></tr></table></figure>
<p><strong>9、特性检测</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(document.body.ontouchstart!==undefined)&#123;</span><br><span class="line">   //是触屏设备</span><br><span class="line">&#125;else&#123;</span><br><span class="line">   //不是触屏设备</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>四、解决一些问题</strong></p>
<p>1、当窗口变大变小，能够保证画板自适应的放缩</p>
<p>这里需要注意的是，onresize 响应事件处理中，获取到的页面尺寸参数是变更后的参数。</p>
<p>2、使用了 svg，那么 file 协议的预览就无法看到图片，所以打开 node.js 输入命令行安装一个 http 协议预览的功能，输入命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g http-server</span><br></pre></td></tr></table></figure>
<p>运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http-server -c-1 //清除缓存预览</span><br><span class="line">hs -c-1 //与上面等价</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/07/Vue-Webpack-ToDoList课程笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/07/Vue-Webpack-ToDoList课程笔记/" itemprop="url">Vue-Webpack-ToDoList课程笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-07T00:04:12+08:00">
                2018-11-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Vue-Webpack-ToDoList课程笔记"><a href="#Vue-Webpack-ToDoList课程笔记" class="headerlink" title="Vue-Webpack-ToDoList课程笔记"></a>Vue-Webpack-ToDoList课程笔记</h2><h3 id="1-1-课程介绍"><a href="#1-1-课程介绍" class="headerlink" title="1-1 课程介绍"></a>1-1 课程介绍</h3><p>一、前端的价值：</p>
<p>1、搭建前端工程：数据缓存、es6和less（可以加快开发效率）。</p>
<p>2、网络优化：http(所有静态资源都是通过http请求的)。</p>
<p>3、api定制。</p>
<p>4、node.js层。</p>
<p>二、vue-cli生成的项目就是基于webpack的前端工程。</p>
<h3 id="2-1-vue-loader-webpack项目配置"><a href="#2-1-vue-loader-webpack项目配置" class="headerlink" title="2-1 vue-loader+webpack项目配置"></a>2-1 vue-loader+webpack项目配置</h3><p>一、vscode直接打开命令行：control+`(esc下面的按键)</p>
<p>二、webpack、vue项目</p>
<p>1、npm init：初始化npm 项目。</p>
<p>2、npm i webpack vue vue-loader (i代表install)：不区分dev-dependency，和dependency</p>
<p>3、npm i css-loader vue-template-compiler(2安装完后，提示需要安装的依赖，3完成安装)</p>
<p>三、组件不能直接挂载到html中。</p>
<p>四、render接收h参数，这个参数实际上是vue里的creatApp，通过它把app挂载到html中，render是渲染内容，如果是要挂载，还要用$mount.</p>
<p>五、package.json里的scripts加上”build”: “webpack –config webpack.config.js”，这样才会调用项目里的webpack，如果是输命令，会调用全局的webpack。</p>
<p>六、npm run build ,报错：you may need an appropriate loader to hand this file type.</p>
<p>需要为.vue文件类型声明一个loader(vue-loader).</p>
<p>webpack原生只支持js.</p>
<p>七、把零碎的js 打包成一个，可以减少http请求。</p>
<h3 id="2-2-webpack配置项目加载各种静态资源及css预处理器"><a href="#2-2-webpack配置项目加载各种静态资源及css预处理器" class="headerlink" title="2-2 webpack配置项目加载各种静态资源及css预处理器"></a>2-2 webpack配置项目加载各种静态资源及css预处理器</h3><p>一、.vue用loader,.css用use，style-loader把css写到html中，css-loader便于webpack处理css文件.</p>
<p>二、loader是可以配置一些选项的。</p>
<p>三、url-loader可以把图片转换成base-64代码，编写在js中，limit:1024，如果图片大小小于1024，就编译成base-64。</p>
<p>四、npm i style-loader url-loader file-loader, url-loader依赖于file-loader。</p>
<p>五、css预处理器:stylus</p>
<p>六、npm i stylus-loader</p>
<p>七、sass,less都可以在webpack中配置相关的loader</p>
<h3 id="2-3-webpack-dev-server的配置和使用"><a href="#2-3-webpack-dev-server的配置和使用" class="headerlink" title="2-3 webpack-dev-server的配置和使用"></a>2-3 webpack-dev-server的配置和使用</h3><p>一、安装dev-server静态资源包：npm i webpack-dev-server</p>
<p>webpack通过build启动webpack.config.js,webpack就会帮我们去打包js代码</p>
<p>二、安装cross-env包: npm i cross-env</p>
<p>不同平台上设置的环境变量是不一样的，mac上NODE_ENV=production就能读取环境变量</p>
<p>windows要用set，因为不想不同平台写不同的命令，所以用cross-env，写cross-env NODE_ENV=production 这样不同平台都可以执行同一个脚本。</p>
<p>启动脚本时设置的环境变量都是存放在process.env这个变量中的。</p>
<p>三、cofig.devSever中的host，如果是’0.0.0.0’，就能通过localhost,127.0.0,ip访问。</p>
<p>四、错误信息不覆盖在页面，输出在控制台（这样习惯多了）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">errorOverlay: false, // false:错误不显示在覆盖层</span><br></pre></td></tr></table></figure>
<p>overlay:  /‘ovəlɛi/：覆盖图，覆盖物。</p>
<p>五、npm i html-webpack-plugin</p>
<h3 id="3-1-vue2的核心知识介绍"><a href="#3-1-vue2的核心知识介绍" class="headerlink" title="3-1 vue2的核心知识介绍"></a>3-1 vue2的核心知识介绍</h3><p>一、vue是一个组件化框架</p>
<p>二、react有jsx，html通过render方法动态生成，每次有数据变化，都会执行render方法，生成Html.</p>
<p>三、重点：数据绑定，vue文件开发方式，render</p>
<p>四、vue的api重点：</p>
<p>（1）生命周期方法（跟react学习的）</p>
<p>（2）computed，是一个reactive框架（声明好的数据，一旦改变，就会影响依赖这些数据的地方，如template依赖于data里的数据，data改变时，template改变）。</p>
<h3 id="3-2-配置vue的jsx写法以及postcss"><a href="#3-2-配置vue的jsx写法以及postcss" class="headerlink" title="3-2 配置vue的jsx写法以及postcss"></a>3-2 配置vue的jsx写法以及postcss</h3><p>一、npm i postcss-loader autoprefixer babel-loader babel-core</p>
<p>二、postcss帮我们后处理css，autoprefixer：需要为浏览器加前缀属性的， babel：演示如何使用render，vue可以写jsx代码</p>
<p>三、npm i babel-preset-env babel-plugin-transform-vue-jsx</p>
<p>四、npm i babel-helper-vue-jsx-merge-props babel-plugin-syntax-jsx</p>
<h3 id="3-3-实现todo应用的界面"><a href="#3-3-实现todo应用的界面" class="headerlink" title="3-3 实现todo应用的界面"></a>3-3 实现todo应用的界面</h3><p>一、scoped：样式只在这个组件起作用。</p>
<p>二、vue结构更清晰，jsx功能更强大。</p>
<p>三、如果v-for中用:key，循环是一个非常费资源的操作，如果下次循环key的值没有变，就会复用节点，不会新增节点。key可用item,:key=”item”</p>
<p>四、class写字符串，:class,可以写数组，也可以写对象</p>
<h3 id="3-4-实现todo应用的业务逻辑"><a href="#3-4-实现todo应用的业务逻辑" class="headerlink" title="3-4 实现todo应用的业务逻辑"></a>3-4 实现todo应用的业务逻辑</h3><p>一、vue或react开发的时候，尽量将数据都集中在顶层的一个地方。</p>
<p>二、vue中$emit触发事件，父组件通过@监听事件，实现父子组件通信。</p>
<p>子组件用this.$emit(‘de’, this.deleted)，父组件用@del=””监听，可以实现父子组件事件的解耦，父组件想监听就监听，不想监听就不监听。</p>
<p>三、chrome插件：vue.js devtools的安装，地址：<a href="https://segmentfault.com/a/1190000009682735%E3%80%82" target="_blank" rel="noopener">https://segmentfault.com/a/1190000009682735。</a> </p>
<p>四、this.todos.splice(this.todos.findIndex(todo =&gt; todo.id === id), 1);</p>
<p>传进去的是todo，如果todo的id等于id，就删掉一个节点。</p>
<p>五、数组的filter方法</p>
<p>var ages = [32, 33, 16, 40];</p>
<p>function myFunction() {</p>
<p>​    document.getElementById(“demo”).innerHTML = </p>
<p>​        ages.filter( item =&gt; item &gt;=18).length;</p>
<p>}</p>
<p>得到[32,33,40]。</p>
<p>六、如果用splice一条一条删，删了一条之后，index会改变，后续无法删，所以用filter。</p>
<p>数据在哪里声明，就在哪里操作。</p>
<p>七、findIndex()。</p>
<p>findIndex() 方法返回传入一个测试条件（函数）符合条件的数组第一个元素位置。</p>
<p>findIndex() 方法为数组中的每个元素都调用一次函数执行：</p>
<ul>
<li>当数组中的元素在测试条件时返回 <em>true</em> 时, findIndex() 返回符合条件的元素的索引位置，之后的值不会再调用执行函数。</li>
<li>如果没有符合条件的元素返回 -1</li>
</ul>
<p>（1） findIndex() 对于空数组，函数是不会执行的。</p>
<p>（2）findIndex() 并没有改变数组的原始值。</p>
<h3 id="4-1-webpack配置css单独分离打包"><a href="#4-1-webpack配置css单独分离打包" class="headerlink" title="4-1 webpack配置css单独分离打包"></a>4-1 webpack配置css单独分离打包</h3><p>一、npm i extract-text-webpack-plugin，把非javascript的文件打包</p>
<p>二、webpack的devserver不能用chunkHash，不然是会报错的。</p>
<p>三、vue-loader处理中，组件中的样式，组件显示的时候，样式才会显示，异步加载组件时，css也异步加载过来。</p>
<h3 id="4-2-webpack区分打包类库代码及hash优化"><a href="#4-2-webpack区分打包类库代码及hash优化" class="headerlink" title="4-2 webpack区分打包类库代码及hash优化"></a>4-2 webpack区分打包类库代码及hash优化</h3><p>一、hash和chunkhash的区别：</p>
<p>整个应用是同一个hash</p>
<p>entry里的节点对应不同的chunkhash</p>
<p>如果是单独打包就用chunkhash</p>
<p>二、name:runtime：生成在app.js的内容，有新的模块加入时，webpack会给每个内容加上一个Id,可能插入在中间，所以id都会改变</p>
<h3 id="5-1-课程总结"><a href="#5-1-课程总结" class="headerlink" title="5-1 课程总结"></a>5-1 课程总结</h3><p>一、vue1.0支持html引入vue.js，2.0基本已经把这个功能舍弃，提倡vue打包webapp。</p>
<p>jsx是在vue2.0才提供的。</p>
<p>二、vue生态环境：vue-router, vuex</p>
<p>三、理解vue的重点不是api和指令，而是过程。</p>
<p>template是通过vue-loader解析成render方法，放到对象中。每次vue数据更新，都会重新调用render方法，生成新的html结构，插到dom结构中。</p>
<p>四、眼界要放宽。学习更多的知识，来完善自己的知识体系。</p>
<p>五、vue是双向绑定框架，通过v-model进行数据的绑定。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/06/画一只皮卡丘/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/06/画一只皮卡丘/" itemprop="url">画一只皮卡丘</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-06T23:13:16+08:00">
                2018-11-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>如何让代码自动播放同步画一只pikachu？</h1>



<p><strong>关键词：</strong>JavaScript、jQuery、Prism.js、Rem响应式页面 </p>

<p><strong></strong>动态向 style 标签和 pre 标签添加文本，绘制出大白的过程。用css3实现动画的效果，用prism.js实现代码高亮的效果，用rem实现响应式布局。</p>

<p><strong>源码链接：</strong><a href="https://tikktoo.github.io/pikachu-demo/" target="_blank" rel="noopener">pikachu</a></p>
<p><strong>预览链接：</strong><a href="https://tikktoo.github.io/pikachu-demo/" target="_blank" rel="noopener">pikachu</a></p>
<h2>一、所需要的知识点</h2>

<h3>1、pre 标签</h3>

<p>表示预定义格式文本。在该元素中的文本通常按照原文件中的编排，以等宽字体的形式展现出来，文本中的空白符（比如空格和换行符）都会显示出来。</p>

<h3>2、API</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">styleCode.substring(0,n) //获取字变量styleCode里0-n个字符串</span><br><span class="line">code.scrollTop = 10000 // 窗口向下滚动10000像素</span><br></pre></td></tr></table></figure>
<h3>3、prism.js</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var styleCode=`</span><br><span class="line">body&#123;</span><br><span class="line">   background:blue;</span><br><span class="line">&#125;`</span><br><span class="line">code.innerHTML = Prism.highlight(styleCode, Prism.languages.css, &apos;css&apos;);</span><br></pre></td></tr></table></figure>
<h3>4、css画图</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">background:linear-gradient</span><br><span class="line">    (135deg, #ffffff 0%,#d2d2d2 100%);   //背景渐变</span><br><span class="line">box-shadow:-0.2rem -0.2rem 0.84rem 0 </span><br><span class="line">    rgb(150, 150, 150) inset;  //内阴影，加上inset</span><br><span class="line">border-radius:0% 0% 50% 30%</span><br><span class="line">    /0% 0% 72% 42%;    //画一个椭圆，斜杠前表示水平半径，后面表示垂直半径</span><br></pre></td></tr></table></figure>
<p>渐变和阴影用工具网站生成即可，椭圆自己反复的修改到合适为止即可。</p>

<h3>5、加meta:vp</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;&gt;</span><br></pre></td></tr></table></figure>
<h3>6、动态rem</h3>

<ul><br>    <li>在一个页面图的尺寸，用px（$px）表示：</li><br></ul>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">height：px(350)  //表示高度为350px</span><br></pre></td></tr></table></figure>
<ul><br>    <li>在js加上一段代码，获取视口宽度并按适当比例赋值给html的font-size</li><br></ul>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var pageWidth=window.innerWidth  //获取屏幕宽度</span><br><span class="line">document.documentElement.style.fontSize= `$&#123;pageWidth/60&#125;px`</span><br></pre></td></tr></table></figure>
<p>我这里用的60倍的放缩。</p>



<h2>二、功能实现</h2>

<h3>1、代码自动播放</h3>

<p>创建 style 、 pre 标签，并添加id</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">    …</span><br><span class="line">   &lt;style id = &apos;styleTag&apos;&gt;&lt;/style&gt; </span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">   &lt;pre id = &apos;code&apos;&gt;&lt;/pre&gt;//使格式按照打的格式呈现出来</span><br><span class="line">    …</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>在两标签添加css样式内容</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var styleCode =`abcdefghijklmn`</span><br><span class="line">var n = 0 </span><br><span class="line">var during = 100</span><br><span class="line">var id = setTimeout(function fn()&#123;</span><br><span class="line">    n=n+1 </span><br><span class="line"> //添加显示的内容</span><br><span class="line">    code.innerHTML = styleCode.substring(0,n)</span><br><span class="line"> //添加样式内容</span><br><span class="line">    styleTag.innerHTML = styleCode.substring(0,n)</span><br><span class="line"> if(n &lt; styleCode.length)&#123;</span><br><span class="line">        setTimeout(fn,during)</span><br><span class="line">&#125;,during)</span><br></pre></td></tr></table></figure>
<p>这里选用了setTimeout，并没有用setInterval，是因为后面我们要加调速功能，setTimeout可以改during，而setInterval只读取一次during。</p>

<h3>2、代码高亮prism.js</h3>

<p></p><p>官网地址：</p><a href="http://prismjs.com/index.html" target="_blank" rel="noopener">prism.js</a><p></p>
<ul><br>    <li>下载prism的js和css</li><br>    <li>分别插入head和body里</li><br>    <li>代码引用，并修改成自己需要的样式</li><br></ul>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// The code snippet you want to highlight, as a string</span><br><span class="line">var code = &quot;var data = 1;&quot;;</span><br><span class="line">// Returns a highlighted HTML string</span><br><span class="line">var html = Prism.highlight(code, Prism.languages.javascript, &apos;javascript&apos;);</span><br></pre></td></tr></table></figure>
<h3>3、调速</h3>

<ul>
<li>在html创建3个button</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;buttons&quot;&gt;</span><br><span class="line">   &lt;button class=&quot;slow&quot;&gt;慢速&lt;/button&gt;</span><br><span class="line">   &lt;button class=&quot;normal&quot;&gt;正常&lt;/button&gt;</span><br><span class="line">   &lt;button class=&quot;fast&quot;&gt;快速&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>引入jq，并使用事件委托</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var $buttons = $(&quot;.buttons&quot;)</span><br><span class="line">$buttons.on(&apos;click&apos;,&apos;button&apos;,function(e)&#123;</span><br><span class="line">   var $button =$(e.currentTarget)</span><br><span class="line">   var speed = $button.attr(&apos;class&apos;)</span><br><span class="line">   switch(speed)&#123;</span><br><span class="line">     case &apos;slow&apos;:</span><br><span class="line">        during = 100</span><br><span class="line">        break;</span><br><span class="line">     case &apos;normal&apos;:</span><br><span class="line">        during = 30</span><br><span class="line">        break;</span><br><span class="line">     case &apos;fast&apos;:</span><br><span class="line">        during = 1</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>基本上重要的逻辑已经完成了，然后就是不断的调试修改和完善。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/25/cookie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/25/cookie/" itemprop="url">Cookie</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-25T20:43:35+08:00">
                2018-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文章整理自:<a href="https://wangdoc.com/javascript/bom/cookie.html#expires%EF%BC%8Cmax-age" target="_blank" rel="noopener">阮一峰Cookie</a><br>参考<a href="https://zhuanlan.zhihu.com/p/22396872?refer=study-fe" target="_blank" rel="noopener">「每日一题」简述 Cookie 是什么</a></p>
<h2 id="什么是Cookie"><a href="#什么是Cookie" class="headerlink" title="什么是Cookie"></a>什么是Cookie</h2><p>Cookie 是<strong>服务器保存在浏览器</strong>的一小段<strong>文本信息</strong>。浏览器每次向服务器<strong>发出请求</strong>，就会<strong>自动附上</strong>这段信息。</p>
<h2 id="Cookie的作用"><a href="#Cookie的作用" class="headerlink" title="Cookie的作用"></a>Cookie的作用</h2><ol>
<li>Cookie 主要用来分辨两个请求<strong>是否来自同一个浏览器</strong></li>
<li>用来<strong>保存</strong>一些<strong>状态信息</strong>，例如：<ul>
<li>对话（<strong>session</strong>）管理：<strong>保存登录</strong>、购物车等需要记录的信息。</li>
<li>个性化：<strong>保存用户的偏好</strong>，比如网页的字体大小、背景色等等。</li>
<li>追踪：<strong>记录和分析用户行为</strong>。</li>
</ul>
</li>
</ol>
<p><strong>不推荐</strong>使用Cookie作为<strong>客户端存储</strong>，原因：</p>
<ol>
<li>它的容量很小（4KB）</li>
<li>缺乏数据操作接口</li>
<li>而且会影响性能</li>
</ol>
<p>客户端储存应该使用 <strong>Web storage API</strong> 和 <strong>IndexedDB</strong>。</p>
<h2 id="Cookie的组成"><a href="#Cookie的组成" class="headerlink" title="Cookie的组成"></a>Cookie的组成</h2><p>Cookie 包含以下几方面的信息:</p>
<ol>
<li>Cookie 的<strong>名字</strong></li>
<li>Cookie 的<strong>值</strong>（真正的<strong>数据</strong>写在这里面）(1、2两点就是键值对 )</li>
<li><strong>到期时间</strong></li>
<li><strong>所属域名</strong>（默认是当前域名）</li>
<li><strong>生效的路径</strong>（默认是当前网址）</li>
</ol>
<p>(3/4/5是cookie的属性)</p>
<h2 id="Cookie的作用过程"><a href="#Cookie的作用过程" class="headerlink" title="Cookie的作用过程"></a>Cookie的作用过程</h2><p>举例来说:</p>
<ol>
<li>用户访问网址<a href="http://www.example.com，服务器在浏览器写入一个" target="_blank" rel="noopener">www.example.com，服务器在浏览器写入一个</a> Cookie。这个 Cookie<br>就会包含<a href="http://www.example.com这个**域名**(第4点)，以及**根路径/**(第5点)。" target="_blank" rel="noopener">www.example.com这个**域名**(第4点)，以及**根路径/**(第5点)。</a>(这意味着，这个 Cookie 对该域名的根路径和它的所有子路径都有效。如果路径设为/forums，那么这个 Cookie 只有在访问<a href="http://www.example.com/forums及其子路径时才有效。" target="_blank" rel="noopener">www.example.com/forums及其子路径时才有效。</a>)</li>
<li>以后，浏览器一旦访问这个路径，<strong>浏览器</strong>就会附上这段 Cookie <strong>发送给服务器</strong>。</li>
</ol>
<h3 id="Cookies作用范围"><a href="#Cookies作用范围" class="headerlink" title="Cookies作用范围"></a>Cookies作用范围</h3><p>浏览器的同源政策规定，两个网址只要<strong>域名相同</strong>和<strong>端口相同</strong>，就可以共享 Cookie（参见《<a href="https://wangdoc.com/javascript/bom/same-origin.html" target="_blank" rel="noopener">同源政策</a>》一章）。注意，这里<strong>不要求协议相同</strong>。也就是说，<code>http://example.com</code>设置的 Cookie，可以被<code>https://example.com</code>读取</p>
<h2 id="HTTP-协议中的Cookie"><a href="#HTTP-协议中的Cookie" class="headerlink" title="HTTP 协议中的Cookie"></a>HTTP 协议中的Cookie</h2><h3 id="HTTP-回应：Cookie-的生成-服务器端生成cookies"><a href="#HTTP-回应：Cookie-的生成-服务器端生成cookies" class="headerlink" title="HTTP 回应：Cookie 的生成(服务器端生成cookies)"></a>HTTP 回应：Cookie 的<strong>生成</strong>(<strong>服务器端</strong>生成cookies)</h3><p>服务器如果希望在浏览器保存 Cookie，就要在 HTTP 回应的头信息里面，放置一个<code>Set-Cookie</code>字段.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie:foo=bar</span><br></pre></td></tr></table></figure>
<p>上面代码会在浏览器保存一个名为<code>foo</code>的 Cookie，它的值为<code>bar</code>。<br>(设置的格式为:<code>&lt;键(名)&gt;=&lt;值&gt;</code>)</p>
<p>HTTP 回应可以包含多个<code>Set-Cookie</code>字段，即在浏览器生成多个 Cookie。下面是一个例子。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.0 200 OK</span><br><span class="line">Content-type: text/html</span><br><span class="line">Set-Cookie: yummy_cookie=choco</span><br><span class="line">Set-Cookie: tasty_cookie=strawberry</span><br><span class="line"></span><br><span class="line">[page content]</span><br></pre></td></tr></table></figure>
<p>除了 Cookie 的值，<code>Set-Cookie</code>字段还可以附加 Cookie 的属性。</p>
<p>一个<code>Set-Cookie</code>字段里面，可以同时包括多个属性，没有次序的要求。</p>
<p>下面是设置一个Cookie的例子:除了名与它的值,还包含<code>Domain</code>属性<code>Secure</code>属性和<code>HttpPnly</code>属性:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; Secure; HttpOnly</span><br></pre></td></tr></table></figure>
<p>除了<code>键=值</code>来设置cookie的名字和值之外,还可以设置属性。</p>
<ol>
<li><code>Expires</code>，<code>Max-Age</code>用来设置cookie持续时间</li>
<li><code>Domain</code>，<code>Path</code>设置发送http请求时那些域名和路径需要附带这个Cookie</li>
<li><code>Secure</code>属性指定浏览器只有在加密协议 HTTPS 下才能发送</li>
<li><code>HttpOnly</code>属性指定该 Cookie 无法通过 JavaScript 脚本拿到</li>
</ol>
<p><a href="https://wangdoc.com/javascript/bom/cookie.html#cookie-%E7%9A%84%E5%B1%9E%E6%80%A7" target="_blank" rel="noopener">具体用法看这里Cookie 的属性—阮一峰</a></p>
<h3 id="HTTP-请求：Cookie-的发送-浏览器发送Cookie"><a href="#HTTP-请求：Cookie-的发送-浏览器发送Cookie" class="headerlink" title="HTTP 请求：Cookie 的发送(浏览器发送Cookie)"></a>HTTP 请求：Cookie 的<strong>发送</strong>(<strong>浏览器</strong>发送Cookie)</h3><p>浏览器向服务器<strong>发送 HTTP 请求时</strong>，每个请求都会<strong>带上相应的 Cookie</strong>。也就是说，把服务器早前保存在浏览器的这段信息，<strong>再发回服务器</strong>。这时要使用 HTTP 头信息的Cookie字段。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: foo=bar</span><br></pre></td></tr></table></figure>
<p>上面代码会向服务器发送名为foo的 Cookie，值为bar。</p>
<p>Cookie字段可以包含多个 Cookie，使用分号（;）分隔。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: name=value; name2=value2; name3=value3</span><br></pre></td></tr></table></figure>
<p>下面是一个Http请求的例子。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /sample_page.html HTTP/1.1</span><br><span class="line">Host: www.example.org</span><br><span class="line">Cookie: yummy_cookie=choco; tasty_cookie=strawberry</span><br></pre></td></tr></table></figure>
<p>服务器收到浏览器发来的 Cookie 时，有两点是无法知道的(<strong>因为这些Cookie的属性只保存在浏览器上</strong>)。</p>
<ol>
<li>Cookie 的<strong>各种属性</strong>，比如何时过期。</li>
<li><strong>哪个域名设置的 Cookie</strong>，到底是一级域名设的，还是某一个二级域名设的。</li>
</ol>
<h2 id="document-cookie读写当前网页的Cookie"><a href="#document-cookie读写当前网页的Cookie" class="headerlink" title="document.cookie读写当前网页的Cookie"></a><code>document.cookie</code>读写当前网页的Cookie</h2><h3 id="读Cookie"><a href="#读Cookie" class="headerlink" title="读Cookie"></a>读Cookie</h3><p>读取的时候，它会<strong>返回当前网页的所有</strong> Cookie，前提是该 Cookie 不能有<code>HTTPOnly</code>属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie // &quot;foo=bar;baz=bar&quot;</span><br></pre></td></tr></table></figure>
<h3 id="写Coookie"><a href="#写Coookie" class="headerlink" title="写Coookie"></a>写Coookie</h3><p><code>document.cookie</code>属性是可写的，可以通过它为当前网站添加 Cookie。<br><strong>等号两边不能有空格</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie = &apos;fontSize=14&apos;;</span><br></pre></td></tr></table></figure>
<p>但是，<code>document.cookie</code>一次只能写入一个 Cookie，而且写入并不是覆盖，而是添加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">document.cookie = &apos;test1=hello&apos;;</span><br><span class="line">document.cookie = &apos;test2=world&apos;;</span><br><span class="line">document.cookie</span><br><span class="line">// test1=hello;test2=world</span><br></pre></td></tr></table></figure>
<p>写入 Cookie 的时候，可以一起写入 Cookie 的属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie = &quot;foo=bar; expires=Fri, 31 Dec 2020 23:59:59 GMT&quot;;</span><br></pre></td></tr></table></figure>
<p>各个属性的写入注意点如下。</p>
<p><code>path</code>属性必须为绝对路径，默认为当前路径。<br><code>domain</code>属性值必须是当前发送 Cookie 的域名的一部分。比如，当前域名是<code>example.com</code>，就不能将其设为<code>foo.com</code>。该属性默认为当前的一级域名（不含二级域名）。<br><code>max-age</code>属性的值为秒数。<br><code>expires</code>属性的值为 <strong>UTC</strong> 格式，可以使用<code>Date.prototype.toUTCString()</code>进行日期格式转换。<br><code>document.cookie</code>写入 Cookie 的例子如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">document.cookie = &apos;fontSize=14; &apos;</span><br><span class="line">  + &apos;expires=&apos; + someDate.toGMTString() + &apos;; &apos;</span><br><span class="line">  + &apos;path=/subdirectory; &apos;</span><br><span class="line">  + &apos;domain=*.example.com&apos;;</span><br></pre></td></tr></table></figure>
<p>Cookie 的属性一旦设置完成，就<strong>没有办法读取这些属性的值</strong>。</p>
<h3 id="Cookie-的删除"><a href="#Cookie-的删除" class="headerlink" title="Cookie 的删除"></a>Cookie 的删除</h3><p>删除一个现存 Cookie 的唯一方法，是<strong>设置</strong>它的<code>expires</code>属性为一个<strong>过去的日期</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie = &apos;fontSize=;expires=Thu, 01-Jan-1970 00:00:01 GMT&apos;;</span><br></pre></td></tr></table></figure>
<p>上面代码中，名为<code>fontSize</code>的 Cookie 的值为空，过期时间设为1970年1月1月零点，就等同于删除了这个 Cookie。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/25/以登录注册理解Cookie的作用过程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/25/以登录注册理解Cookie的作用过程/" itemprop="url">以登录注册理解Cookie的作用过程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-25T20:43:35+08:00">
                2018-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Cookie在注册登录时的作用过程："><a href="#Cookie在注册登录时的作用过程：" class="headerlink" title="Cookie在注册登录时的作用过程："></a>Cookie在注册登录时的作用过程：</h2><h2 id="过程："><a href="#过程：" class="headerlink" title="过程："></a>过程：</h2><h3 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h3><p>注册时把账号密码写入数据库</p>
<h3 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h3><p>第一次登录时服务器给浏览器发送Cookie.</p>
<p>后台的登录路由代码(nodejs):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">else if (path === &apos;/sign_in&apos; &amp;&amp; method === &apos;POST&apos;) &#123;</span><br><span class="line">        readBody(request).then((body) =&gt; &#123;</span><br><span class="line">            let strings = body.split(&apos;&amp;&apos;) // [&apos;email=1&apos;, &apos;password=2&apos;, &apos;password_confirmation=3&apos;]</span><br><span class="line">            let hash = &#123;&#125;</span><br><span class="line">            strings.forEach((string) =&gt; &#123;</span><br><span class="line">                // string == &apos;email=1&apos;</span><br><span class="line">                let parts = string.split(&apos;=&apos;) // [&apos;email&apos;, &apos;1&apos;]</span><br><span class="line">                let key = parts[0]</span><br><span class="line">                let value = parts[1]</span><br><span class="line">                hash[key] = decodeURIComponent(value) // hash[&apos;email&apos;] = &apos;1&apos;</span><br><span class="line">            &#125;)</span><br><span class="line">            let &#123;</span><br><span class="line">                email,</span><br><span class="line">                password</span><br><span class="line">            &#125; = hash</span><br><span class="line">            var users = fs.readFileSync(&apos;./db/users&apos;, &apos;utf8&apos;)</span><br><span class="line">            try &#123;</span><br><span class="line">                users = JSON.parse(users) // []</span><br><span class="line">            &#125; catch (exception) &#123;</span><br><span class="line">                users = []</span><br><span class="line">            &#125;</span><br><span class="line">            let found</span><br><span class="line">            for (let i = 0; i &lt; users.length; i++) &#123;</span><br><span class="line">                if (users[i].email === email &amp;&amp; users[i].password === password) &#123;</span><br><span class="line">                    found = true</span><br><span class="line">                    break</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (found) &#123;//关键在这里,验证成功,设置登录Cookie为登录的邮箱,并放在响应里发给浏览器</span><br><span class="line">                response.setHeader(&apos;Set-Cookie&apos;, `sign_in_email=$&#123;email&#125;`)</span><br><span class="line">                response.statusCode = 200</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                response.statusCode = 401</span><br><span class="line">            &#125;</span><br><span class="line">            response.end()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在登录成功的一瞬间,需要后台设置一个Cookie,记录一下登陆的用户id(这里用邮箱表示,代码在上面),然后发响应给浏览器<br>例如在服务器端设置响应头：<code>set-cookies：user_email=1@mtt.com</code></p>
<p>这时候我们查看响应：</p>
<p><img src="https://segmentfault.com/img/bVbhGdq?w=943&amp;h=544" alt="clipboard.png"></p>
<p>发现响应头已经设置cookie.</p>
<p><img src="https://segmentfault.com/img/bVbhGdr?w=875&amp;h=465" alt="clipboard.png"></p>
<p>然后跳转到主页，这时候我们查看跳转到主页的请求：</p>
<p><img src="https://segmentfault.com/img/bVbhGds?w=1189&amp;h=1325" alt="clipboard.png"></p>
<p>发现跳转到主页的请求头中包含cookie字段(以后访问这个域名都会带着这个Cookie)!所以，就像上篇文章说的：</p>
<p>如果服务器给了浏览器一个setcookie的响应头，那么这个浏览器以后所有的请求，只要是相同的源(即就是上次给我发送Cookie的那个域名,域名和端口相同)，那就么就会把当时服务器发给这个浏览器的Cookie带着</p>
<blockquote>
<p>以后，浏览器一旦访问这个路径，浏览器就会附上这段 Cookie 发送给服务器</p>
</blockquote>
<p>即:第一次请求,服务器为浏览器设置Cookie.下次请求,浏览器带上Cookie,发送给服务器.<br>第一次登录的时候,服务器给浏览器的响应设置一个Cookie,<code>set-cookies：user_email=1@mtt.com</code>,然后当浏览器下次进行请求的时候,发现Cookie中有名为User_email的Cookie,而且我发送请求的域名还是上次发给我带Cookie的响应的那个域名.</p>
<p>那么就无需再次登录了.相当于服务器给浏览器发了进入门票,下次或下下次浏览器在进入服务器的时候给服务器看票就可以了</p>
<h2 id="后台读取Cookie保留登录状态与删除Cookie退出登录状态"><a href="#后台读取Cookie保留登录状态与删除Cookie退出登录状态" class="headerlink" title="后台读取Cookie保留登录状态与删除Cookie退出登录状态"></a>后台读取Cookie保留登录状态与删除Cookie退出登录状态</h2><p>首页代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;我是首页&lt;/h1&gt;</span><br><span class="line">    &lt;div class=&quot;&quot;&gt;</span><br><span class="line">        &lt;a href=&quot;./sign_up&quot;&gt;注册&lt;/a&gt;</span><br><span class="line">        &lt;a href=&quot;./sign_in&quot;&gt;登录&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;h1&gt;你的状态是:__status__&lt;/h1&gt;</span><br><span class="line">    &lt;h1&gt;你的邮箱账号是:__email__&lt;/h1&gt;</span><br><span class="line">    &lt;h1&gt;你的密码是:__password__&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">    &lt;a href=&quot;javascript:;&quot; id=&quot;logOffBtn&quot;&gt;退出登录(删除cookie)&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">logOffBtn.addEventListener(&quot;click&quot;, () =&gt; &#123;</span><br><span class="line">        // 删除一个现存 Cookie 的唯一方法，是设置它的expires属性为一个过去的日期。</span><br><span class="line">        document.cookie = &apos;sign_in_email=;expires=Thu, 01-Jan-1970 00:00:01 GMT&apos;</span><br><span class="line">        window.location = &quot;/&quot;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>后台路由代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">if (path === &apos;/&apos;) &#123;</span><br><span class="line">        response.statusCode = 200</span><br><span class="line">        let string = fs.readFileSync(&apos;./index.html&apos;)</span><br><span class="line">        string = string.toString();</span><br><span class="line">        var users = fs.readFileSync(&apos;./db/users&apos;, &apos;utf8&apos;)</span><br><span class="line">        users = JSON.parse(users)//转化为user对象数组</span><br><span class="line"></span><br><span class="line">        console.log(users);</span><br><span class="line">        let cookies = request.headers.cookie || &apos;&apos;//[&apos;email=111&apos;, &apos;asdasd=111&apos;]</span><br><span class="line">        cookies = cookies.split(&quot;; &quot;)</span><br><span class="line">        let hash=&#123;&#125;</span><br><span class="line">        cookies.forEach((string)=&gt;&#123;</span><br><span class="line">            let parts = string.split(&quot;=&quot;)</span><br><span class="line">            let key = parts[0]</span><br><span class="line">            let value = parts[1]</span><br><span class="line">            hash[key] = value;</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">        let eamil = hash.sign_in_email</span><br><span class="line">        let foundedUser</span><br><span class="line">        users.forEach((userObj)=&gt;&#123;</span><br><span class="line">            if(userObj.email===eamil)&#123;</span><br><span class="line">                foundedUser = userObj;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        console.log(foundedUser);</span><br><span class="line">        if(foundedUser)&#123;</span><br><span class="line">            string = string.replace(&apos;__status__&apos;, &apos;已登录&apos;)</span><br><span class="line">            string = string.replace(&apos;__email__&apos;, foundedUser.email)</span><br><span class="line">            string = string.replace(&apos;__password__&apos;, foundedUser.password)</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            string = string.replace(&apos;__status__&apos;, &apos;未登录,请去登录&apos;)</span><br><span class="line">            string = string.replace(&apos;__email__&apos;, &apos;没&apos;)</span><br><span class="line">            string = string.replace(&apos;__password__&apos;, &apos;没&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        response.setHeader(&apos;Content-Type&apos;, &apos;text/html;charset=utf-8&apos;)</span><br><span class="line">        response.write(string)</span><br><span class="line">        response.end()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在没有Cookie的时候,首页的状态</p>
<p><img src="https://segmentfault.com/img/bVbhJaG?w=841&amp;h=428" alt="clipboard.png"></p>
<p>登录之后,后台根据Cookie查询数据库,将用户名与密码传到前台的首页上</p>
<p><img src="https://segmentfault.com/img/bVbhJa1?w=1077&amp;h=1070" alt="clipboard.png"></p>
<p>退出登录将删除Cookie并刷新页面,重新回到未登录的状态</p>
<h2 id="Cookie在登录的时候的特点"><a href="#Cookie在登录的时候的特点" class="headerlink" title="Cookie在登录的时候的特点"></a>Cookie在登录的时候的特点</h2><p>我们得到Cookie的特点:</p>
<ol>
<li>第一次登录的时候,服务器通过 Set-Cookie 响应头设置 Cookie,然后以响应的形式发给浏览器</li>
<li>浏览器得到 响应中Cookie 之后，之后每次请求这个域名都要带上这个 Cookie</li>
<li>之后服务器读取当时自己设置的 Cookie 就知道登录用户的信息（email）</li>
</ol>
<h2 id="几个关于Cookie的问题"><a href="#几个关于Cookie的问题" class="headerlink" title="几个关于Cookie的问题"></a>几个关于Cookie的问题</h2><p>1.我在 Chrome 登录了得到 Cookie，用 Safari 访问，Safari 会带上 Cookie 吗<br>no</p>
<p>2.Cookie 存在哪<br>Windows 存在 C 盘的一个文件里</p>
<p>3.Cookie会被用户篡改吗？<br>可以，例如在谷歌浏览器开发者模式下的application-&gt;Cookie中可以手动修改,修改之后,下次发送请求时,附带的就是修改后的Cookie</p>
<p><img src="https://image-static.segmentfault.com/269/812/2698121046-5b9bc1e20a4ba_articlex" alt="修改Cookie"></p>
<p>JS中也有可以操作cookie的api<br>( 假如换成别的用户的账号,那么还可以登录成功的话,就会存在风险问题.Session 来解决这个问题，防止用户篡改)<br>后端可以强制设置不允许修改Cookie，只要将Cookie的属性设置为<code>Httponly</code>即可(还可以手动改,但是JS改不了,也无法获取),具体语法看 MDN<br>4.Cookie 有效期吗？<br>默认有效期20分钟左右，不同浏览器策略不同(如果浏览器一直开着,那么Cookie不会被删除.如果关闭浏览器,那么浏览器为了安全考虑,20分钟左右后可能会删除Cookie.这也取决于服务器如何设置Cookie的有效期)<br>后端可以强制设置有效期，具体语法看 MDN<br>Cookie 遵守同源策略吗？<br>也有，不过跟 AJAX 的同源策略稍微有些不同。<br>当请求 qq.com 下的资源时，浏览器会默认带上 qq.com 对应的 Cookie，不会带上 baidu.com 对应的 Cookie<br>当请求 v.qq.com 下的资源时，浏览器不仅会带上 v.qq.com 的Cookie，还会带上 qq.com 的 Cookie<br>另外 Cookie 还可以根据路径做限制，请自行了解，这个功能用得比较少。</p>
<h2 id="需要注意的细节问题"><a href="#需要注意的细节问题" class="headerlink" title="需要注意的细节问题"></a>需要注意的细节问题</h2><h3 id="为什么前后端都要进行表单验证"><a href="#为什么前后端都要进行表单验证" class="headerlink" title="为什么前后端都要进行表单验证?"></a>为什么前后端都要进行表单验证?</h3><p>前后端都要验证邮箱格式是否正确，账号密码格式是否正确，两次提交的密码是否相同等。<br>因为黑客可以绕过前端的js验证流程，例如黑客可以直接使用curl 进行请求的发送，直接与后台服务器进行交互。<br>如图:</p>
<p><img src="https://image-static.segmentfault.com/410/641/4106417372-5baf73ddaef3e_articlex" alt="clipboard.png"></p>
<p>所以后台也需要进行表单验证。</p>
<h3 id="Cookie如何手动关闭"><a href="#Cookie如何手动关闭" class="headerlink" title="Cookie如何手动关闭"></a>Cookie如何手动关闭</h3><p><img src="https://image-static.segmentfault.com/236/619/2366198568-5baf39b6c0fa5_articlex" alt="clipboard.png"></p>
<h3 id="翻译"><a href="#翻译" class="headerlink" title="翻译"></a>翻译</h3><p>cookie：曲奇饼<br>cache-control：缓存控制</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/07/简化版自己实现jQuery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/07/简化版自己实现jQuery/" itemprop="url">简化版自己实现jQuery</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-07T06:10:28+08:00">
                2018-09-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="简化版自己实现jQuery"><a href="#简化版自己实现jQuery" class="headerlink" title="简化版自己实现jQuery"></a>简化版自己实现jQuery</h1><h2 id="1-与"><a href="#1-与" class="headerlink" title="1. == 与==="></a>1. == 与===</h2><p>尽量不要用 == 规则太复杂<br><img src="https://s1.ax1x.com/2018/05/27/ChUuAf.png" alt="ChUuAf.png"></p>
<p>用===只需要注意两点,1.NaN===NaN,false,2.所有对象===也都是false,因为地址不一样.<br><img src="https://s1.ax1x.com/2018/05/27/ChUM4S.png" alt="ChUM4S.png"></p>
<h2 id="2-自己写jQuery与用jQuery"><a href="#2-自己写jQuery与用jQuery" class="headerlink" title="2.自己写jQuery与用jQuery"></a>2.自己写jQuery与用jQuery</h2><p><img src="https://s1.ax1x.com/2018/05/27/Ch7FXj.png" alt="Ch7FXj.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;jQuery-Study&lt;/title&gt;</span><br><span class="line">    &lt;script src=&quot;01_myjQuery1.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;jQuery3.3.1min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .red&#123;</span><br><span class="line">            color: red;</span><br><span class="line">       	 &#125;		</span><br><span class="line">       	 .blue&#123;</span><br><span class="line">            color: blue;</span><br><span class="line">        &#125;</span><br><span class="line">        .big&#123;</span><br><span class="line">            font-size: larger;</span><br><span class="line">        &#125;</span><br><span class="line">        .green&#123;</span><br><span class="line">            color: green;</span><br><span class="line">        &#125;</span><br><span class="line">        .pink&#123;</span><br><span class="line">            color: pink;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!--ul&gt;li[id=item$]&#123;这是li$&#125;*8--&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li id=&quot;item1&quot;&gt;这是li1&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item2&quot;&gt;这是li2&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item3&quot;&gt;这是li3&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item4&quot; class=&quot;xxx&quot;&gt;这是li4&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item5&quot;&gt;这是li5&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item6&quot;&gt;这是li6&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item7&quot;&gt;这是li7&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;item8&quot;&gt;这是li8&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;button id=&quot;x&quot;&gt;x&lt;/button&gt;</span><br><span class="line">&lt;ol id=&quot;ol2&quot;&gt;</span><br><span class="line">    &lt;li id=&quot;i1&quot;&gt;1&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;i2&quot;&gt;2&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;i3&quot;&gt;3&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;i4&quot;&gt;4&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;i5&quot;&gt;5&lt;/li&gt;</span><br><span class="line">&lt;/ol&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    console.log(&apos;直接使用&apos;);</span><br><span class="line">    console.log(getSiblings(item1));</span><br><span class="line"></span><br><span class="line">    console.log(&apos;直接使用&apos;);</span><br><span class="line">    addClass(item2,&#123;a:true,xxx:false,c:true&#125;);</span><br><span class="line">    console.log(item2);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;UseJquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>01_myjQuery1.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line">// 得到兄妹结点</span><br><span class="line">//传入的参数是一个节点,返回兄妹结点的数组</span><br><span class="line">function getSiblings(node) &#123;</span><br><span class="line">    var allSilings = node.parentNode.children;</span><br><span class="line">    var siblingsArray = &#123;length:0&#125;;</span><br><span class="line">    for (let i = 0; i &lt; allSilings.length; i++) &#123;</span><br><span class="line">        if (allSilings[i]!==node)&#123;</span><br><span class="line">            siblingsArray[siblingsArray.length] = allSilings[i];</span><br><span class="line">            siblingsArray.length++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return siblingsArray;</span><br><span class="line">&#125;</span><br><span class="line">//添加或删除class</span><br><span class="line">//传入的第一个参数是结点,第二个参数是对象, 这个对象里是key:value,key就是要操作的class,value判断操作类型,true添加,false删除</span><br><span class="line">function addClass(node,object)&#123;</span><br><span class="line">    for (let key in object)&#123;</span><br><span class="line">        //对象调用方法的两种方式:</span><br><span class="line">        // obj.f()</span><br><span class="line">        // obj[&apos;f&apos;]()</span><br><span class="line"></span><br><span class="line">        var methodName;</span><br><span class="line"></span><br><span class="line">        methodName = object[key] ? &apos;add&apos;:&apos;remove&apos;;</span><br><span class="line">        node.classList[methodName](key);</span><br><span class="line"></span><br><span class="line">        /*上面两句代码相当于</span><br><span class="line">        if (object[key]) &#123;</span><br><span class="line">            node.classList.add(key);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            node.classList.remove(key);</span><br><span class="line">        &#125;*/</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">window.mydom = &#123;&#125;;</span><br><span class="line">mydom.getSiblings = getSiblings;</span><br><span class="line">mydom.addClass = addClass;//命名空间,常用的设计或者组合就叫做设计模式.哈希,数组,都是一种设计模式</span><br><span class="line">//所以jQuery就是这样来的,jQuery就是一个命名空间,里面有很多函数.</span><br><span class="line"></span><br><span class="line">// 命名空间作用:1.方便识别库,2.如果都放在window里,可能会覆盖别的库,所以命名空间是为了防止覆盖别的函数</span><br><span class="line"></span><br><span class="line">window.onload = function () &#123;</span><br><span class="line">// 测试</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // 如何直接使用item3.addclass()?,item3.getSiblings()?</span><br><span class="line">    // 方法一:给原型链加公有属性公有方法,但是有缺点,容易覆盖</span><br><span class="line">    Node.prototype.getSiblings = function () &#123;</span><br><span class="line">        var allSilings = this.parentNode.children;//谁调用这个函数,this就是谁</span><br><span class="line">        var siblingsArray = &#123;length:0&#125;;</span><br><span class="line">        for (let i = 0; i &lt; allSilings.length; i++) &#123;</span><br><span class="line">            if (allSilings[i]!==this)&#123;</span><br><span class="line">                siblingsArray[siblingsArray.length] = allSilings[i];</span><br><span class="line">                siblingsArray.length++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return siblingsArray;</span><br><span class="line">    &#125;</span><br><span class="line">    let item3 = document.getElementById(&apos;item3&apos;);</span><br><span class="line">    // console.log(item3.getSiblings.call(item3));如果用cal.第一个参数就是函数里的this,如果不用call(),那么this就自动变成了item3</span><br><span class="line">    console.log(&apos; 方法一:&apos;);</span><br><span class="line">    console.log(item3.getSiblings());//测试成功</span><br><span class="line"></span><br><span class="line">    Node.prototype.addClass = function (object) &#123;</span><br><span class="line">        for (let key in object)&#123;</span><br><span class="line">            var methodName;</span><br><span class="line">            methodName = object[key] ? &apos;add&apos;:&apos;remove&apos;;</span><br><span class="line">            this.classList[methodName](key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // item3.addClass.call(item3,&#123;a:true,xxx:false,c:true&#125;);;如果用call.第一个参数就是函数里的this,如果不用call(),那么this就自动变成了item3</span><br><span class="line">    console.log(&apos; 方法一:&apos;);</span><br><span class="line">    item3.addClass.call(item3,&#123;a:true,xxx:false,c:true&#125;);</span><br><span class="line">    // item3.addClass(&#123;a:true,xxx:false,c:true&#125;);</span><br><span class="line">    console.log(item3);//测试成功</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // 如何直接使用item3.addclass()?,item3.getSiblings()?</span><br><span class="line">    // 方法二:因为方法一在原型中添加函数容易覆盖,所以自己做一个类似的Node出来</span><br><span class="line">    var Node2 = function (node) &#123;// 将要操作的结点传进去,然后返回一个对象,这个对象里给添加了有操作这个节点方法,所以对象.方法就可以实现操作了,而不需要mydom.addclass(item3,...)这样了</span><br><span class="line">        return&#123;</span><br><span class="line">            getSiblings: function () &#123;</span><br><span class="line">                var allSilings = node.parentNode.children;</span><br><span class="line">                var siblingsArray = &#123;length:0&#125;;</span><br><span class="line">                for (let i = 0; i &lt; allSilings.length; i++) &#123;</span><br><span class="line">                    if (allSilings[i]!==node)&#123;</span><br><span class="line">                        siblingsArray[siblingsArray.length] = allSilings[i];</span><br><span class="line">                        siblingsArray.length++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                return siblingsArray;</span><br><span class="line">            &#125;,</span><br><span class="line">            addClass:function (object) &#123;</span><br><span class="line">                for (let key in object)&#123;</span><br><span class="line"></span><br><span class="line">                    var methodName;</span><br><span class="line"></span><br><span class="line">                    methodName = object[key] ? &apos;add&apos;:&apos;remove&apos;;</span><br><span class="line">                    node.classList[methodName](key);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    let item4 = document.getElementById(&apos;item4&apos;);</span><br><span class="line"></span><br><span class="line">    var item4obj = Node2(item4);</span><br><span class="line"></span><br><span class="line">    console.log(&apos; 方法二:&apos;);</span><br><span class="line">    console.log(item4obj.getSiblings());//测试成功</span><br><span class="line"></span><br><span class="line">    console.log(&apos; 方法二:&apos;);</span><br><span class="line">    item4obj.addClass(&#123;a:true,xxx:false,c:true&#125;);</span><br><span class="line">    console.log(item4);//测试成功</span><br><span class="line"></span><br><span class="line">    // 改为jQuery</span><br><span class="line">    var jQuery = function (nodeOrSelector) &#123;//将Node2改为jQuery,jQuery可以根据选择器去找到对应的元素</span><br><span class="line">        var node;</span><br><span class="line">        if(typeof nodeOrSelector===&quot;string&quot;)&#123;</span><br><span class="line">            node = document.querySelector(nodeOrSelector);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            node = nodeOrSelector;</span><br><span class="line">        &#125;</span><br><span class="line">        return&#123;</span><br><span class="line">            getSiblings: function () &#123;</span><br><span class="line">                var allSilings = node.parentNode.children;</span><br><span class="line">                var siblingsArray = &#123;length:0&#125;;</span><br><span class="line">                for (let i = 0; i &lt; allSilings.length; i++) &#123;</span><br><span class="line">                    if (allSilings[i]!==node)&#123;</span><br><span class="line">                        siblingsArray[siblingsArray.length] = allSilings[i];</span><br><span class="line">                        siblingsArray.length++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                return siblingsArray;</span><br><span class="line">            &#125;,</span><br><span class="line">            addClass:function (object) &#123;</span><br><span class="line">                for (let key in object)&#123;</span><br><span class="line"></span><br><span class="line">                    var methodName;</span><br><span class="line"></span><br><span class="line">                    methodName = object[key] ? &apos;add&apos;:&apos;remove&apos;;</span><br><span class="line">                    node.classList[methodName](key);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    let item5 = document.getElementById(&apos;item5&apos;);</span><br><span class="line"></span><br><span class="line">    var $item5 = jQuery(item5);</span><br><span class="line">    console.log(&apos; 改为jQuery方法:&apos;);</span><br><span class="line">    console.log($item5.getSiblings());</span><br><span class="line"></span><br><span class="line">    console.log(&apos; 改为jQuery方法:&apos;);</span><br><span class="line">    $item5.addClass(&#123;red:true,xxx:false,c:true&#125;);</span><br><span class="line">    console.log(item5);//测试成功</span><br><span class="line">     var child3 = jQuery(&apos;ul&gt;li:nth-child(3)&apos;);</span><br><span class="line">     child3.addClass(&#123;blue:true&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     // jQuery操作多个节点</span><br><span class="line">    var jQueryS = function (nodeOrSelector) &#123;</span><br><span class="line">        var node = &#123;&#125;;</span><br><span class="line">        if (typeof nodeOrSelector ===&apos;string&apos;)&#123;</span><br><span class="line">            var temp = document.querySelectorAll(nodeOrSelector);//先用querySelectorAll获取这个伪数组</span><br><span class="line">            for (let i = 0; i &lt; temp.length; i++) &#123;</span><br><span class="line">                node[i] = temp[i];</span><br><span class="line">            &#125;</span><br><span class="line">            node.length = temp.length;//将伪数组净化,净化成只有0123值和length的伪数组</span><br><span class="line"></span><br><span class="line">        &#125; else if(nodeOrSelector instanceof Node)&#123;// 如果是node,也将其转化成伪数组</span><br><span class="line">            node[0] =nodeOrSelector;</span><br><span class="line">            node.length = 1;</span><br><span class="line">        &#125;</span><br><span class="line">        node.getSiblings = function () &#123;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        node.addClass = function (classesArray) &#123;//传入class数组,给选择的多个节点都加上数组中class</span><br><span class="line">            classesArray.forEach(value=&gt;&#123;</span><br><span class="line">                for (let i = 0; i &lt; node.length; i++) &#123;</span><br><span class="line">                    node[i].classList.add(value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        node.getTexts = function () &#123;</span><br><span class="line">            var texts=[];</span><br><span class="line">            for (let i = 0; i &lt; node.length; i++) &#123;</span><br><span class="line">                texts.push(node[i].textContent);</span><br><span class="line">            &#125;</span><br><span class="line">            return texts;</span><br><span class="line">        &#125;</span><br><span class="line">        node.setTexts = function (text) &#123;</span><br><span class="line">            for (let i = 0; i &lt; node.length; i++) &#123;</span><br><span class="line">                node[i].textContent = text;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //set和get合并</span><br><span class="line">        node.text = function (text) &#123;</span><br><span class="line">            if (text===undefined)&#123;</span><br><span class="line">                var texts=[];</span><br><span class="line">                for (let i = 0; i &lt; node.length; i++) &#123;</span><br><span class="line">                    texts.push(node[i].textContent);</span><br><span class="line">                &#125;</span><br><span class="line">                return texts;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                for (let i = 0; i &lt; node.length; i++) &#123;</span><br><span class="line">                    node[i].textContent = text;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var allNodes = jQueryS(&apos;ul&gt;li:nth-child(even)&apos;);//偶数孩子</span><br><span class="line">    allNodes.addClass([&apos;big&apos;,&apos;green&apos;]);</span><br><span class="line">    console.log(allNodes.getTexts());</span><br><span class="line">    console.log(allNodes.text());</span><br><span class="line">    // console.log(allNodes.text(1));//测试成功</span><br><span class="line"></span><br><span class="line">    //总结:jQuery的作用就是将选择其选择的元素放到一个对象里,这个对象里有01234标序,代表每一个选择的元素,有length代表所有元素加起来总共的长度,有各种方法,addclass,gettext等等.就是反悔了这样一个hash</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>UseJquery.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var $nodes  = $(&apos;ul&gt;li:nth-child(even)&apos;);//注意$nodesjQuery声明的变量前面要加一个$,防止混淆,因为jQuery声明的变量只能用jQuery的api,不能用dom的api.</span><br><span class="line">console.log($nodes);</span><br><span class="line">x.onclick = function () &#123;</span><br><span class="line">    $nodes.toggleClass(&apos;pink&apos;);//toggle,开关,切换</span><br><span class="line">    // console.log(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var colorArray = [&apos;blue&apos;,&apos;yellow&apos;,&apos;red&apos;,&apos;pink&apos;,&apos;big&apos;]</span><br><span class="line">var $nodes2 = $(&apos;#ol2&gt;li&apos;);</span><br><span class="line">$nodes2.addClass(function (index,currentClass) &#123;</span><br><span class="line">    return colorArray[index];//ol里面的每一个li加了&apos;blue&apos;,&apos;yellow&apos;,&apos;red&apos;,&apos;pink&apos;,&apos;big&apos;这几个属性</span><br><span class="line">&#125;)</span><br><span class="line">//https://www.jquery123.com/addClass/</span><br></pre></td></tr></table></figure>
<h2 id="3-this-和-arguments"><a href="#3-this-和-arguments" class="headerlink" title="3.this 和 arguments"></a>3.<code>this</code> 和 <code>arguments</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f.call(asThis, input1,input2)</span><br></pre></td></tr></table></figure>
<p>其中 <code>asThis</code> 会被当做 <code>this</code>，[input1,input2] 会被当做 <code>arguments</code><br>禁止使用 <code>f(input1, input2)</code>，因为学会 <code>.call</code> 才能理解 <code>this</code></p>
<p><code>this</code> 和 <code>arguments</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function f()&#123;</span><br><span class="line">    &apos;use strict&apos;</span><br><span class="line">    console.log(this)</span><br><span class="line">    console.log(arguments)</span><br><span class="line">    return undefined</span><br><span class="line">&#125;</span><br><span class="line">f.call(1,2,3) // this 为 1，arguments 为 [2,3]</span><br></pre></td></tr></table></figure>
<p><a href="https://zhuanlan.zhihu.com/p/23804247" target="_blank" rel="noopener">this 的值到底是什么？一次说清楚—方应杭</a><br><strong>this定义:this是call的第一个参数.</strong><br><strong>this定义:this是call的第一个参数.</strong><br><strong>this定义:this是call的第一个参数.</strong><br><a href="https://zhuanlan.zhihu.com/p/22486908" target="_blank" rel="noopener">「每日一题」JS中的闭包是什么？—方应杭</a></p>
<p>关于原型链:<br><a href="https://zhuanlan.zhihu.com/p/23090041?refer=study-fe" target="_blank" rel="noopener">「每日一题」什么是 JS原型链？—方应杭</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/22989691" target="_blank" rel="noopener">JavaScript 世界万物诞生记</a></p>
<p><img src="https://s1.ax1x.com/2018/05/27/ChN7kT.png" alt="ChN7kT.png"><br>dom就是一个命名的空间,命名的所属对象<br>函数库:特定种类的API<br>jQueryMobil已经过时,不要学</p>
<h2 id="jQuery的原型"><a href="#jQuery的原型" class="headerlink" title="jQuery的原型"></a>jQuery的原型</h2><p>测试代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=&quot;http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        console.log($.prototype)</span><br><span class="line">        console.log($.prototype.__proto__)</span><br><span class="line">        console.log($.prototype.__proto__ === Object.prototype)//继承自Object</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>结果如下:<br><img src="https://s1.ax1x.com/2018/06/14/CXIos1.png" alt="CXIos1.png"></p>
<p><img src="https://s1.ax1x.com/2018/06/14/CXo8W4.png" alt="CXo8W4.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/28/原型与原型链/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/28/原型与原型链/" itemprop="url">原型与原型链</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-28T21:46:45+08:00">
                2018-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-公用属性（就是原型）"><a href="#1-公用属性（就是原型）" class="headerlink" title="1. 公用属性（就是原型）"></a>1. 公用属性（就是原型）</h2><p>每个对象都有toString()、valueof()等方法，但他们并其实没有单独的方法，而是JS在每个对象里都存了一个隐藏属性：<strong>proto</strong>，这个属性指向了存放公用属性的地址(Object.prototype)，当用toString()时，就是调用的公用属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o1.toString === o2.toString   //true</span><br></pre></td></tr></table></figure>
<p>同时Number对象还有它特有公用属性，所以它比Object要多一个公用属性库，并且会先访问Number的原型（公用属性库），<strong>这一条链就叫原型链</strong>，像下图<a href="https://pengyize.github.io/images/%E5%8E%9F%E5%9E%8B%E9%93%BE.png" target="_blank" rel="noopener"><img src="https://pengyize.github.io/images/%E5%8E%9F%E5%9E%8B%E9%93%BE.png" alt="原型链"></a><br>同理，String、boolean也有自己的原型，但若平常没被引用的话会被当作垃圾回收，所以平常对象的原型是Object.prototype在引用，可得⬇️</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object.prototype === o1.__proto__     //true，是把prototype的地址赋给__proto__属性了</span><br></pre></td></tr></table></figure>
<p>所以它们最终指向的Object的公有属性，就是Object.prototype（原型），Number、String的特有公有属性也是它们的prototype属性在引用，同理有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Number.prototype.__proto__ === Object.prototype //true，是把Object.prototype的地址赋给Number的__proto__属性了</span><br><span class="line"></span><br><span class="line">var n1 = new Number(1);</span><br><span class="line">n1.__proto__ === Number.prototype    //true，是把Number.prototype的地址赋给n1的__proto__属性了</span><br><span class="line">n1.__proto__.__proto__ === Object.prototype  //true</span><br></pre></td></tr></table></figure>
<h2 id="2-proto和prototype的区别"><a href="#2-proto和prototype的区别" class="headerlink" title="2. proto和prototype的区别"></a>2. <strong>proto</strong>和prototype的区别</h2><p><a href="https://pengyize.github.io/images/%E5%8E%9F%E5%9E%8B.png" target="_blank" rel="noopener"><img src="https://pengyize.github.io/images/%E5%8E%9F%E5%9E%8B.png" alt="原型.png"></a><br>打开浏览器就相当于生成了一个window，里面存了Number、String、Boolean、Object这几个对象，对象里的prototype属性里存了它们原型的地址，在你写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var n = new Number(1);     //就会把Number.prototype里的地址放入n的__proto__属性里</span><br></pre></td></tr></table></figure>
<p>这样用n就能调用Number的原型了</p>
<p>总结：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var 对象 = new 函数();		//函数可以是Number/String/Boolean/Object</span><br><span class="line">对象.__proto__ === 函数.prototype    //true</span><br></pre></td></tr></table></figure>
<p><strong>proto</strong>是对象的属性，prototype是函数的属性</p>
<p><strong>面试题</strong>：<code>&#39;1&#39;.__proto__</code>是什么？<br>答：’1’会临时转化为String对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;1&apos;.__proto__ === String.prototype    //true</span><br></pre></td></tr></table></figure>
<p>所有对象都有<strong>proto</strong>属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Object.prototype.__proto__ === null;</span><br><span class="line"></span><br><span class="line">1.toString()     //语法错误，不加引号JS会把.当作小数点</span><br><span class="line">1..toString()    //&apos;1&apos;，第一个.当作小数点，第二个为点操作符</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/28/JS数据类型的转换/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shi qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Martin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/28/JS数据类型的转换/" itemprop="url">JS数据类型的转换</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-28T14:01:58+08:00">
                2018-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="七种数据类型："><a href="#七种数据类型：" class="headerlink" title="七种数据类型："></a>七种数据类型：</h1><ul>
<li>number</li>
<li>string</li>
<li>boolean</li>
<li>symbol</li>
<li>undefined</li>
<li>null</li>
<li>object</li>
</ul>
<p>没有 Array ! 没有 Function !</p>
<h2 id="number"><a href="#number" class="headerlink" title="number"></a>number</h2><ul>
<li>小数：0.1 等同于 .1</li>
<li>0.1 + 0.2 !== 0.3 此处得到结果0.30000000000000004（惊喜+意外）</li>
<li>科学计数法 1.23e2 表示为1.23乘10的2次方</li>
<li>自动转换为 数值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&apos;5&apos; - &apos;2&apos; // 3</span><br><span class="line">&apos;5&apos; * &apos;2&apos; // 10</span><br><span class="line">true - 1  // 0</span><br><span class="line">false - 1 // -1</span><br><span class="line">&apos;1&apos; - 1   // 0</span><br><span class="line">&apos;5&apos; * []    // 0</span><br><span class="line">false / &apos;5&apos; // 0</span><br><span class="line">&apos;abc&apos; - 1   // NaN</span><br><span class="line">null + 1 // 1</span><br><span class="line">undefined + 1 // NaN</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：<code>null</code>转为数值时为<code>0</code>，而<code>undefined</code>转为数值时为<code>NaN</code>。</p>
</blockquote>
<p>一元运算符也会把运算子转成数值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+&apos;abc&apos; // NaN</span><br><span class="line">-&apos;abc&apos; // NaN</span><br><span class="line">+true // 1</span><br><span class="line">-false // 0</span><br></pre></td></tr></table></figure>
<p><strong>如何转换为 number</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Number(&apos;1&apos;) === 1</span><br><span class="line">parseInt(&apos;1&apos;, 10) === 1 // 10表示10进制，同理可填入其它进制转换为其它进制</span><br><span class="line">parseFloat(&apos;1.23&apos;) === 1.23</span><br><span class="line">&apos;1&apos; - 0 === 1</span><br><span class="line">+ &apos;1&apos; === 1</span><br><span class="line">- &apos;1&apos; === -1</span><br></pre></td></tr></table></figure>
<h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><ul>
<li>转义：’\’</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">转义单引号</span><br><span class="line">var a = &apos;\&apos;&apos;</span><br><span class="line">转义\</span><br><span class="line">var b = &apos;\\&apos;</span><br><span class="line">转义回车</span><br><span class="line">var enter = &apos;\n&apos;</span><br><span class="line">转义Tab</span><br><span class="line">var tab = &apos;\t&apos;</span><br></pre></td></tr></table></figure>
<ul>
<li>多行字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var s = `123</span><br><span class="line">456`</span><br></pre></td></tr></table></figure>
<ul>
<li>自动转换为字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&apos;5&apos; + 1 // &apos;51&apos;</span><br><span class="line">&apos;5&apos; + true // &quot;5true&quot;</span><br><span class="line">&apos;5&apos; + false // &quot;5false&quot;</span><br><span class="line">&apos;5&apos; + &#123;&#125; // &quot;5[object Object]&quot;</span><br><span class="line">&apos;5&apos; + [] // &quot;5&quot;</span><br><span class="line">&apos;5&apos; + function ()&#123;&#125; // &quot;5function ()&#123;&#125;&quot;</span><br><span class="line">&apos;5&apos; + undefined // &quot;5undefined&quot;</span><br><span class="line">&apos;5&apos; + null // &quot;5null&quot;</span><br></pre></td></tr></table></figure>
<h2 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h2><blockquote>
<p>JavaScript 遇到预期为布尔值的地方（比如<code>if</code>语句的条件部分），就会将非布尔值的参数自动转换为布尔值。系统内部会自动调用<code>Boolean</code>函数。<br>因此除了以下五个值，其他都是自动转为<code>true</code>。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">undefined</span><br><span class="line">null</span><br><span class="line">+0或-0</span><br><span class="line">NaN</span><br><span class="line">&apos;&apos;（空字符串）</span><br></pre></td></tr></table></figure>
<blockquote>
<p>下面两种写法，有时也用于将一个表达式转为布尔值。它们内部调用的也是<code>Boolean</code>函数。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 写法一</span><br><span class="line">expression ? true : false</span><br><span class="line"></span><br><span class="line">// 写法二</span><br><span class="line">!! expression</span><br></pre></td></tr></table></figure>
<h2 id="undefined-和-null"><a href="#undefined-和-null" class="headerlink" title="undefined 和 null"></a>undefined 和 null</h2><ul>
<li>都表示没有值，至于 JS 为什么有两个表示「没有值」的东西。</li>
</ul>
<blockquote>
<p>（规范）如果一个变量没有被赋值，那么这个变量的值就是 undefiend<br>（习俗）如果你想表示一个还没赋值的对象，就用 null。如果你想表示一个还没赋值的字符串/数字/布尔/symbol，就用 undefined（但是实际上你直接 var xxx 一下就行了，不用写 var xxx = undefined）</p>
</blockquote>
<h2 id="object"><a href="#object" class="headerlink" title="object"></a>object</h2><ul>
<li>Array, Function 都为对象的一种</li>
<li>object 中 key 皆为字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var obj1 = &#123;</span><br><span class="line">  a: 1,</span><br><span class="line">&#125;</span><br><span class="line">var obj2 = &#123;</span><br><span class="line">  &apos;a&apos;: 1,</span><br><span class="line">&#125;</span><br><span class="line">以上二者实际为同一内容</span><br></pre></td></tr></table></figure>
<h2 id="typeof-运算符"><a href="#typeof-运算符" class="headerlink" title="typeof 运算符"></a>typeof 运算符</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;string&apos;, typeof &apos;1&apos;)</span><br><span class="line">console.log(&apos;number&apos;, typeof 1)</span><br><span class="line">console.log(&apos;boolean&apos;, typeof true)</span><br><span class="line">console.log(&apos;symbol&apos;, typeof Symbol(1))</span><br><span class="line">console.log(&apos;undefined&apos;, typeof undefined)</span><br><span class="line">console.log(&apos;null&apos;, typeof null)</span><br><span class="line">console.log(&apos;object&apos;, typeof &#123;&#125;)</span><br><span class="line">console.log(&apos;function&apos;, typeof function f() &#123;&#125;)</span><br></pre></td></tr></table></figure>
<p>需要特别注意的两个地方！</p>
<ul>
<li>null 类型为 object</li>
<li>function 类型为 function，看上去好像没什么不对，但是七种数据类型中没有 function，以上也讲过 function 为对象的一种</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">shi qiang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shi qiang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
